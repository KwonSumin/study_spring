<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="board">
	
	<select id="getMaxSeq">
		select max(seq) from board
	</select>
	
	<select id="total">
		select count(seq) from board 
	</select>
	
	<insert id="insert">
		insert into board(seq,title,reg_id,contents)
			 values( (<include refid="getMaxSeq"/> ),#{title},#{reg_id},#{contents})
	</insert>
	
	<select id="list">
	<if test="searchTarget == null or searchTarget == ''">
		select * from
		 ( select A.*,ROWNUM AS RNUM, count(*) over() AS TOTCNT FROM
		 ( select * from board order by seq desc ) A )
		  where RNUM <![CDATA[>]]> #{startRowNum} AND RNUM <![CDATA[<=]]> #{endRowNum}
	</if>
	<if test="searchTarget != null and searchTarget != ''">
		select * from 
		 ( select A.*,ROWNUM AS RNUM, count(*) over() AS TOTCNT FROM
		  ( select * from board where bean.getSearchTarget() like '%bean.getSearch()%'
		 order by seq desc )  A ) where RNUM <![CDATA[>]]> #{startRowNum} AND RNUM <![CDATA[<=]]> #{endRowNum}
	</if>
	</select>
	
	<select id="getBoard">
		select * from board where
			seq = #{seq}
	</select>
	
	
	
</mapper>